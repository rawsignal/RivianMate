@using RivianMate.Api.Services
@using RivianMate.Core.Entities
@using RivianMate.Core.Enums

<StatusSection Title="Climate" Icon="thermometer">
    <StatusItem Label="Cabin Temp" Value="@FormatTemperature(VehicleState?.CabinTemperature)" />
    <StatusItem Label="Target Temp" Value="@FormatTemperature(VehicleState?.ClimateTargetTemp)" />
    <StatusItem Label="Preconditioning" Value="@FormatBool(VehicleState?.IsPreconditioningActive)" StatusClass="@(VehicleState?.IsPreconditioningActive == true ? "status-active" : "")" />
    <StatusItem Label="Defrost" Value="@FormatBool(VehicleState?.IsDefrostActive)" StatusClass="@(VehicleState?.IsDefrostActive == true ? "status-active" : "")" />
    <StatusItem Label="Pet Mode" Value="@FormatBool(VehicleState?.IsPetModeActive)" StatusClass="@(VehicleState?.IsPetModeActive == true ? "status-warning" : "")" />
</StatusSection>

@code {
    [Parameter] public VehicleState? VehicleState { get; set; }
    [Parameter] public UnitConversionService? UnitService { get; set; }
    [Parameter] public TemperatureUnit TemperatureUnit { get; set; } = TemperatureUnit.Fahrenheit;

    private string FormatTemperature(double? celsius)
    {
        if (celsius == null) return "—";
        return UnitService?.FormatTemperature(celsius, TemperatureUnit) ?? $"{celsius:0}°C";
    }

    private static string FormatBool(bool? value) => value switch
    {
        true => "On",
        false => "Off",
        _ => "—"
    };
}
