@using RivianMate.Core.Entities
@using RivianMate.Core.Enums

<StatusSection Title="Tire Pressure" Icon="circle">
    <div class="tire-grid">
        <div class="tire-row">
            <div class="tire-item @GetTireClass(VehicleState?.TirePressureStatusFrontLeft)">
                <span class="tire-label">FL</span>
                <span class="tire-value">@FormatPressure(VehicleState?.TirePressureFrontLeft, VehicleState?.TirePressureStatusFrontLeft)</span>
            </div>
            <div class="tire-item @GetTireClass(VehicleState?.TirePressureStatusFrontRight)">
                <span class="tire-label">FR</span>
                <span class="tire-value">@FormatPressure(VehicleState?.TirePressureFrontRight, VehicleState?.TirePressureStatusFrontRight)</span>
            </div>
        </div>
        <div class="tire-row">
            <div class="tire-item @GetTireClass(VehicleState?.TirePressureStatusRearLeft)">
                <span class="tire-label">RL</span>
                <span class="tire-value">@FormatPressure(VehicleState?.TirePressureRearLeft, VehicleState?.TirePressureStatusRearLeft)</span>
            </div>
            <div class="tire-item @GetTireClass(VehicleState?.TirePressureStatusRearRight)">
                <span class="tire-label">RR</span>
                <span class="tire-value">@FormatPressure(VehicleState?.TirePressureRearRight, VehicleState?.TirePressureStatusRearRight)</span>
            </div>
        </div>
    </div>
</StatusSection>

@code {
    [Parameter] public VehicleState? VehicleState { get; set; }

    private static string FormatPressure(double? psi, TirePressureStatus? status)
    {
        // Prefer actual PSI value if available
        if (psi.HasValue && psi.Value > 0)
        {
            return $"{psi.Value:F0} PSI";
        }

        // Fall back to status text
        return status switch
        {
            TirePressureStatus.Ok => "OK",
            TirePressureStatus.Low => "Low",
            TirePressureStatus.High => "High",
            TirePressureStatus.Critical => "Critical",
            _ => "â€”"
        };
    }

    private static string GetTireClass(TirePressureStatus? status) => status switch
    {
        TirePressureStatus.Ok => "tire-ok",
        TirePressureStatus.Low => "tire-low",
        TirePressureStatus.High => "tire-high",
        TirePressureStatus.Critical => "tire-critical",
        _ => ""
    };
}
